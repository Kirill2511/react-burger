(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{12:function(e,t,a){e.exports={modal:"modal_modal__1h5My",withTitle:"modal_withTitle__1p9Ls",withoutTitle:"modal_withoutTitle__2TOrY",modalButton:"modal_modalButton__3dLR3",content:"modal_content__vAjff"}},13:function(e,t,a){e.exports={calorificCapacity:"ingredients-details_calorificCapacity__3_9Cb",capacity:"ingredients-details_capacity__2JWcT"}},139:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(19),i=a.n(c),s=a(11),o=a.n(s),d=a(20),l=a(60),p=a(61),j=a(3),u=function(e,t){switch(t.type){case"ingredientsGet":return Object(j.a)(Object(j.a)({},e),{},{ingredients:t.payload});case"ingredientsError":return Object(j.a)(Object(j.a)({},e),{},{ingredientsError:t.payload});case"closeModal":return Object(j.a)(Object(j.a)({},e),{},{modalIsOpen:!1});case"totalPrice":return Object(j.a)(Object(j.a)({},e),{},{totalPrice:t.payload});case"order":return Object(j.a)(Object(j.a)({},e),{},{modalMode:"order-details",modalIsOpen:!0,orderDetails:t.payload,orderError:""});case"orderError":return Object(j.a)(Object(j.a)({},e),{},{modalMode:"order-details",modalIsOpen:!0,orderError:t.payload});case"deleteTopping":return Object(j.a)(Object(j.a)({},e),{},{burgerData:Object(j.a)(Object(j.a)({},e.burgerData),{},{toppings:e.burgerData.toppings.filter((function(e,a){return a!==t.payload}))})});case"addBun":return Object(j.a)(Object(j.a)({},e),{},{burgerData:Object(j.a)(Object(j.a)({},e.burgerData),{},{bun:t.payload}),modalMode:"ingredient-details",modalIsOpen:!0,ingredientInfo:t.payload});case"addTopping":return Object(j.a)(Object(j.a)({},e),{},{burgerData:Object(j.a)(Object(j.a)({},e.burgerData),{},{toppings:[].concat(Object(p.a)(e.burgerData.toppings),[t.payload])}),modalMode:"ingredient-details",modalIsOpen:!0,ingredientInfo:t.payload});default:return e}},m=r.a.createContext(),b=a(4),x=a(22),O=a.n(x),_=a(0),h=function(){return Object(_.jsx)("header",{className:O.a.header,children:Object(_.jsxs)("nav",{className:"".concat(O.a.headerContent," pt-4 pb-4"),children:[Object(_.jsxs)("div",{style:{display:"flex"},children:[Object(_.jsxs)("div",{style:{display:"flex"},className:"mr-2 pl-5 pt-4 pr-5 pb-4",children:[Object(_.jsx)(b.BurgerIcon,{type:"primary"}),Object(_.jsx)("p",{className:"text text_type_main-default ml-2",children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440"})]}),Object(_.jsxs)("div",{style:{display:"flex"},className:"pl-5 pt-4 pr-5 pb-4",children:[Object(_.jsx)(b.ListIcon,{type:"secondary"}),Object(_.jsx)("p",{className:"text text_type_main-default ml-2",children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})]})]}),Object(_.jsx)("div",{className:"".concat(O.a.logoItem," ml-30"),children:Object(_.jsx)(b.Logo,{})}),Object(_.jsxs)("div",{style:{display:"flex"},className:"pl-5 pt-4 pr-5 pb-4",children:[Object(_.jsx)(b.ProfileIcon,{type:"secondary"}),Object(_.jsx)("p",{className:"text text_type_main-default text_color_inactive ml-2",children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"})]})]})})},y=a(17),g=a.n(y),f=function(){var e=Object(n.useContext)(m),t=e.burgerData,a=e.totalPrice,r=e.dispatch,c=t.bun,i=t.toppings;Object(n.useEffect)((function(){var e=2*c.price||0,t=i.reduce((function(e,t){return e+t.price}),0);r({type:"totalPrice",payload:e+t})}),[c,i,r]);return Object(_.jsxs)("section",{style:{width:600},children:[Object(_.jsxs)("div",{className:"".concat(g.a.ingredientsWrapper," mt-25"),children:[c._id&&Object(_.jsx)(b.ConstructorElement,{type:"top",isLocked:!0,text:c.name,price:c.price,thumbnail:c.image_mobile}),Object(_.jsx)("ul",{className:g.a.toppings,children:i.map((function(e,t){return Object(_.jsxs)("li",{style:{width:568,marginRight:18},children:[Object(_.jsx)(b.DragIcon,{type:"primary"}),Object(_.jsx)(b.ConstructorElement,{isLocked:!1,text:e.name,price:e.price,thumbnail:e.image_mobile,handleClose:function(){return r({type:"deleteTopping",payload:t})}})]},"".concat(e._id,"-").concat(t))}))}),c._id&&Object(_.jsx)(b.ConstructorElement,{type:"bottom",isLocked:!0,text:c.name,price:c.price,thumbnail:c.image_mobile})]}),Object(_.jsxs)("div",{className:"".concat(g.a.submitBlock," mt-10 mr-4"),children:[Object(_.jsxs)("span",{className:"".concat(g.a.totalPrice," text text_type_digits-medium mr-10"),children:[a,"\xa0",Object(_.jsx)(b.CurrencyIcon,{type:"primary"})]}),Object(_.jsx)(b.Button,{type:"primary",size:"large",onClick:function(){if(t.bun._id){var e={ingredients:Object.keys(t).flatMap((function(e){switch(e){case"bun":return t.bun._id;case"toppings":return t[e].map((function(e){return e._id}));default:return[]}}))},a=new Request("https://norma.nomoreparties.space/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});Object(d.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(a);case 3:if((t=e.sent).ok){e.next=6;break}throw new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(t.status));case 6:return e.next=8,t.json();case 8:n=e.sent,r({type:"order",payload:n}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),r({type:"orderError",payload:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445..."});case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))()}else r({type:"orderError",payload:"\u0414\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u0430 \u0431\u0443\u043b\u043a\u0430 \u0434\u043b\u044f \u0431\u0443\u0440\u0433\u0435\u0440\u0430"})},children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})]})},v=a(40),N=a.n(v),C=function(e){var t=e.data,a=e.onClick;return Object(_.jsx)("div",{style:{overflow:"hidden"},onClick:function(){return a(t)},children:Object(_.jsxs)("li",{className:"".concat(N.a.ingredientCard),children:[Object(_.jsx)("img",{className:"ml-4 mr-4",src:t.image,alt:t.name}),Object(_.jsxs)("span",{style:{display:"flex"},className:"text text_type_digits-default mt-1 mb-1",children:[t.price,"\xa0",Object(_.jsx)(b.CurrencyIcon,{type:"primary"})]}),Object(_.jsx)("span",{className:"".concat(N.a.ingredientName," text text_type_main-default"),children:t.name})]})})},k=a(8),I=a.n(k),E=function(){var e=Object(n.useContext)(m),t=e.ingredients,a=e.dispatch,r=Object(n.useCallback)((function(e){switch(e.type){case"bun":a({type:"addBun",payload:e});break;case"sauce":case"main":a({type:"addTopping",payload:e})}}),[a]);return Object(_.jsxs)("section",{style:{width:600},className:"mr-10",children:[Object(_.jsx)("h1",{style:{height:40},className:"text text_type_main-large mt-10 mb-5",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(_.jsxs)("div",{style:{display:"flex"},children:[Object(_.jsx)(b.Tab,{value:"bun",active:!0,onClick:function(){},children:"\u0411\u0443\u043b\u043a\u0438"}),Object(_.jsx)(b.Tab,{value:"sauce",active:!1,onClick:function(){},children:"\u0421\u043e\u0443\u0441\u044b"}),Object(_.jsx)(b.Tab,{value:"main",active:!1,onClick:function(){},children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"})]}),Object(_.jsxs)("div",{className:I.a.ingredientsWrapper,children:[Object(_.jsx)("h3",{className:"".concat(I.a.subtitle," text text_type_main-medium"),children:"\u0411\u0443\u043b\u043a\u0438"}),Object(_.jsx)("ul",{className:I.a.ingredientsBlock,children:t.filter((function(e){return"bun"===e.type})).map((function(e){return Object(_.jsx)(C,{data:e,onClick:r},e._id)}))}),Object(_.jsx)("h3",{className:"".concat(I.a.subtitle," text text_type_main-medium"),children:"\u0421\u043e\u0443\u0441\u044b"}),Object(_.jsx)("ul",{className:I.a.ingredientsBlock,children:t.filter((function(e){return"sauce"===e.type})).map((function(e){return Object(_.jsx)(C,{data:e,onClick:r},e._id)}))}),Object(_.jsx)("h3",{className:"".concat(I.a.subtitle," text text_type_main-medium"),children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0430"}),Object(_.jsx)("ul",{className:I.a.ingredientsBlock,children:t.filter((function(e){return"main"===e.type})).map((function(e){return Object(_.jsx)(C,{data:e,onClick:r},e._id)}))})]})]})},w=a(58),D=a.n(w),T=a(59),B=a.n(T),P=function(e){var t=e.onClose,a=Object(n.useRef)(document.createElement("div")),c=Object(n.useCallback)((function(e){27===e.keyCode&&t()}),[t]),i=r.a.useCallback((function(e){var n=e.target;a.current===n&&t()}),[t]);return Object(n.useEffect)((function(){return document.addEventListener("keydown",c),document.addEventListener("click",i),function(){document.removeEventListener("keydown",c),document.removeEventListener("click",i)}})),Object(_.jsx)("div",{ref:a,className:B.a.overlay})},M=a(12),L=a.n(M),R=function(e){var t=e.children,a=e.title,n=e.onClose,r=document.getElementById("modal-root");return i.a.createPortal(Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(P,{onClose:n}),Object(_.jsxs)("div",{className:L.a.modal,children:[Object(_.jsxs)("div",{className:"text text_type_main-large\n                            ".concat(a?L.a.withTitle:L.a.withoutTitle),children:[a,Object(_.jsx)("button",{type:"button",className:L.a.modalButton,onClick:n,children:Object(_.jsx)(b.CloseIcon,{type:"primary"})})]}),Object(_.jsx)("div",{className:L.a.content,children:t})]})]}),r)};R.defaultProps={title:""};var W=R,q=a(13),G=a.n(q),J=function(e){var t=e.data;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("img",{style:{height:240},src:t.image_large,alt:t.name}),Object(_.jsx)("span",{style:{marginTop:16,marginBottom:32},className:"text text_type_main-medium",children:t.name}),Object(_.jsxs)("div",{className:G.a.calorificCapacity,children:[Object(_.jsxs)("div",{className:G.a.capacity,children:[Object(_.jsx)("span",{className:"text text_type_main-default",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438,\u043a\u043a\u0430\u043b"}),Object(_.jsx)("span",{className:"text text_type_digits-default",children:t.calories})]}),Object(_.jsxs)("div",{className:G.a.capacity,children:[Object(_.jsx)("span",{className:"text text_type_main-default",children:"\u0411\u0435\u043b\u043a\u0438,\u0433"}),Object(_.jsx)("span",{className:"text text_type_digits-default",children:t.proteins})]}),Object(_.jsxs)("div",{className:G.a.capacity,children:[Object(_.jsx)("span",{className:"text text_type_main-default",children:"\u0416\u0438\u0440\u044b,\u0433"}),Object(_.jsx)("span",{className:"text text_type_digits-default",children:t.fat})]}),Object(_.jsxs)("div",{className:G.a.capacity,children:[Object(_.jsx)("span",{className:"text text_type_main-default",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b,\u0433"}),Object(_.jsx)("span",{className:"text text_type_digits-default",children:t.carbohydrates})]})]})]})},S=a.p+"static/media/doneIcon.7341dd32.svg",F=a(23),X=a.n(F),A=function(e){var t=e.orderDetails,a=e.orderError;return a?Object(_.jsx)("span",{className:"text text_type_main-medium",children:a}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("span",{className:"text text_type_digits-large ".concat(X.a.orderId),children:t.order.number}),Object(_.jsx)("span",{className:"text text_type_main-medium",children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(_.jsx)("div",{className:X.a.doneIcon,children:Object(_.jsx)("img",{src:S,alt:"done-icon"})}),Object(_.jsxs)("div",{className:X.a.description,children:[Object(_.jsx)("span",{className:"text text_type_main-default",children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(_.jsx)("span",{style:{color:"#8585AD"},className:"text text_type_main-default",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]})]})},H={ingredients:[],ingredientsError:"",ingredientInfo:{},burgerData:{bun:{},toppings:[]},orderDetails:null,orderError:"",modalMode:"",modalIsOpen:!1,totalPrice:0},Q=function(){var e=Object(n.useReducer)(u,H,void 0),t=Object(l.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e=new Request("https://norma.nomoreparties.space/api/ingredients");(function(){var t=Object(d.a)(o.a.mark((function t(){var a,n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if((a=t.sent).ok){t.next=6;break}throw new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(a.status));case 6:return t.next=8,a.json();case 8:n=t.sent,c=n.data,r({type:"ingredientsGet",payload:c}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),r({type:"ingredientsError",payload:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445..."});case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}})()()}),[r]),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(h,{}),Object(_.jsx)("main",{className:D.a.main,children:Object(_.jsxs)(m.Provider,{value:{ingredients:a.ingredients,ingredientsError:a.ingredientsError,burgerData:a.burgerData,modalIsOpen:a.modalIsOpen,totalPrice:a.totalPrice,dispatch:r},children:[Object(_.jsx)(E,{}),Object(_.jsx)(f,{})]})}),a.modalIsOpen&&"ingredient-details"===a.modalMode?Object(_.jsx)(W,{title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430",onClose:function(){return r({type:"closeModal"})},children:Object(_.jsx)(J,{data:a.ingredientInfo})}):null,a.modalIsOpen&&"order-details"===a.modalMode?Object(_.jsx)(W,{onClose:function(){return r({type:"closeModal"})},children:Object(_.jsx)(A,{orderDetails:a.orderDetails,orderError:a.orderError})}):null]})};i.a.render(Object(_.jsx)(r.a.StrictMode,{children:Object(_.jsx)(Q,{})}),document.getElementById("root"))},17:function(e,t,a){e.exports={ingredientsWrapper:"burger-constructor_ingredientsWrapper__2HVYJ",toppings:"burger-constructor_toppings__3V4kg",submitBlock:"burger-constructor_submitBlock__3vGtQ",totalPrice:"burger-constructor_totalPrice__3_P12"}},22:function(e,t,a){e.exports={header:"app-header_header__2ZLMU",headerContent:"app-header_headerContent__qH9Ml",logoItem:"app-header_logoItem__XDxSX"}},23:function(e,t,a){e.exports={orderId:"order-details_orderId__2PLvj",doneIcon:"order-details_doneIcon__18jKu",description:"order-details_description__13cO2"}},40:function(e,t,a){e.exports={ingredientCard:"ingredient-card_ingredientCard__toCGU",ingredientName:"ingredient-card_ingredientName__t0TdD"}},58:function(e,t,a){e.exports={main:"app_main__39tvC"}},59:function(e,t,a){e.exports={overlay:"modal-overlay_overlay__1NjRQ"}},8:function(e,t,a){e.exports={subtitle:"burger-ingredients_subtitle__3nq0X",ingredientsWrapper:"burger-ingredients_ingredientsWrapper__1mqGS",ingredientsBlock:"burger-ingredients_ingredientsBlock__1Z5Ci"}}},[[139,1,2]]]);
//# sourceMappingURL=main.11284c49.chunk.js.map